import{j as e,S as F,k as L,l as N,m as O,n as T,o as M,L as S,u as $,r as f,p as k,I,q as z}from"./index-DRAgKpwA.js";import{c as D}from"./selectUtils-twPIpm5x.js";import{u as P}from"./location-DNuLIXpD.js";import"./_version-BjL_A-pP.js";const g=({label:n,name:s,value:c,onChange:a,placeholder:d,error:t,type:l})=>e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-primaryText dark:text-gray-200",htmlFor:s,children:n}),e.jsx("input",{type:l,id:s,name:s,value:c,onChange:a,placeholder:d,className:"mt-1 block w-full rounded-md border p-2 text-primaryText focus:border-2 focus:border-primary focus:outline-none dark:bg-gray-600 dark:text-gray-200"}),t&&e.jsx("span",{className:"text-xs text-red-500",children:t})]}),B=document.documentElement.classList.contains("dark"),G=({label:n,options:s,value:c,onChange:a,fieldName:d,error:t,placeholder:l})=>e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"font-semibold text-primaryText dark:text-gray-100",children:n}),e.jsx(F,{options:s,placeholder:l,value:s.find(m=>m.value===c),onChange:m=>a(m,d),styles:D(B)}),t&&e.jsx("span",{className:"text-xs text-red-500",children:t})]}),K=()=>{const n=()=>N.get("/sanctum/csrf-cookie"),{data:s,error:c,mutate:a}=L("/api/user-request",()=>N.get("/api/user-request").then(t=>t.data).catch(t=>{if(t.response.status!==409)throw t}));return{userRequest:s,mutate:a,register:async({...t})=>(await n(),console.log("clicked",t),N.post("/api/user-request",t).then(l=>(console.log("Request successfully!"),{message:"Request successfully!",isSuccess:!0})).catch(l=>{var p;console.log(l),(p=l.response)==null||p.status,console.log(l.response.data.message);const m=Object.keys(l.response.data.errors)[0],b=l.response.data.errors[m][0].includes("user id")?"The employee number has already been taken.":l.response.data.errors[m][0];return console.log(b),{message:b,isSuccess:!1}}))}},U=({result:n,onClose:s,message:c})=>n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"w-full max-w-sm rounded-lg bg-white p-6 shadow-lg dark:bg-gray-800",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:e.jsx(O,{size:24})})}),e.jsxs("div",{className:"flex flex-col items-center",children:[n==="success"?e.jsx(T,{size:50,className:"text-green-500"}):e.jsx(M,{size:50,className:"text-red-500"}),e.jsx("h2",{className:"mt-2 text-xl font-semibold text-gray-700 dark:text-white",children:n==="success"?"Request Submitted!":"Error Occurred"}),e.jsx("p",{className:"mt-1 text-center text-gray-600 dark:text-gray-300",children:c})]}),e.jsx("div",{className:"mt-4 flex justify-center",children:n==="success"?e.jsx(S,{to:"/login",children:e.jsx("button",{className:"rounded bg-cyan-to-blue px-4 py-2 text-white hover:bg-cyan-600 dark:bg-cyan-700 dark:hover:bg-cyan-600",children:"Go to Login"})}):e.jsx("button",{onClick:s,className:"rounded bg-red-500 px-4 py-2 text-white hover:bg-red-600 dark:bg-red-700 dark:hover:bg-red-600",children:"Close"})})]})}):null,Q=()=>{const{register:n}=K(),{t:s}=$("common"),{affiliation:c}=P(),[a,d]=f.useState({userId:"",firstName:"",lastName:"",affiliation:"",email:"",password:""}),[t,l]=f.useState({}),[m,b]=f.useState(""),[p,j]=f.useState(!1),[o,y]=f.useState(1),[C,q]=f.useState(""),R=c==null?void 0:c.map(r=>({value:r.name,label:r.name})),V=(r,i)=>{d({...a,[i]:r?r.value:""})},h=r=>{const{name:i,value:x}=r.target;t[i]&&l(u=>{const v={...u};return delete v[i],v}),i==="password"&&x&&x.length<8&&l(u=>({...u,password:s("reqAcc.enterPassword")})),d({...a,[i]:x})},E=async r=>{r.preventDefault(),j(!0);const i={};if(a.firstName||(i.firstName=s("reqAccValidation.firstName")),a.lastName||(i.lastName=s("reqAccValidation.lastName")),a.userId||(i.userId=s("reqAccValidation.employeeId")),a.affiliation||(i.affiliation=s("reqAccValidation.affiliation")),a.email||(i.email=s("reqAccValidation.email")),a.password||(i.password=s("reqAccValidation.password")),Object.keys(i).length>0){l(i),j(!1);return}try{const x=await n({firstName:a.firstName,lastName:a.lastName,affiliation:a.affiliation,email:a.email,password:a.password,isApprove:0,userId:a.userId.trim()}),u=x.isSuccess?"success":"fail";q(u),u==="success"&&(d({userId:"",firstName:"",lastName:"",affiliation:"",email:"",password:""}),y(1)),b(x.message)}catch{alert("An error occurred. Please try again.")}finally{j(!1)}},w=()=>{const r={};if(o===1&&(a.firstName||(r.firstName=s("reqAccValidation.firstName")),a.lastName||(r.lastName=s("reqAccValidation.lastName")),a.userId||(r.userId=s("reqAccValidation.employeeId"))),o===2&&(a.affiliation||(r.affiliation=s("reqAccValidation.affiliation")),a.email||(r.email=s("reqAccValidation.email")),a.password||(r.password=s("reqAccValidation.password"))),Object.keys(r).length>0){l(r);return}l({}),y(i=>Math.min(i+1,3))},A=()=>y(r=>Math.max(r-1,1));return e.jsxs("div",{className:"flex min-h-screen flex-col items-center justify-center px-4 dark:bg-gray-700 xs:bg-white lg:bg-secondary",children:[e.jsxs("form",{onSubmit:E,className:"w-full max-w-sm gap-1 rounded bg-white p-8 text-sm shadow-md xs:bg-none xs:shadow-none dark:xs:bg-transparent",children:[e.jsx("h2",{className:"mb-6 text-center text-2xl font-bold text-gray-700 dark:text-gray-50",children:s("reqAcc.requestAccount")}),e.jsx("div",{className:"mb-4 text-center text-xs text-gray-500 dark:text-gray-200",children:s("reqAcc.fillOutFields")}),e.jsxs("div",{className:"mb-4 flex justify-between text-xs text-gray-500 dark:text-gray-100",children:[e.jsx("div",{className:`w-1/3 ${o===1?"font-medium text-primary":""}`,children:s("reqAcc.personalInfo")}),e.jsx("div",{className:`w-1/3 ${o===2?"font-medium text-primary":""}`,children:s("reqAcc.workInfo")}),e.jsx("div",{className:`w-1/3 ${o===3?"font-medium text-primary":""}`,children:s("reqAcc.review")})]}),e.jsx("div",{className:"mb-4 h-1 bg-gray-300",children:e.jsx("div",{className:"h-full bg-cyan-to-blue",style:{width:`${(o-1)*33.33}%`}})}),o===1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-2 text-sm",children:[e.jsx(g,{label:s("reqAcc.firstName"),type:"text",name:"firstName",value:a.firstName,onChange:h,placeholder:s("reqAcc.enterFirstName"),error:t.firstName}),e.jsx(g,{label:s("reqAcc.lastName"),name:"lastName",type:"text",value:a.lastName,onChange:h,placeholder:s("reqAcc.enterLastName"),error:t.lastName}),e.jsx(g,{label:s("reqAcc.employeeNumber"),type:"text",name:"userId",value:a.userId,onChange:h,placeholder:s("reqAcc.enterEmployeeNumber"),error:t.userId})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{type:"button",onClick:w,className:"inline-flex items-center gap-2 rounded bg-cyan-to-blue px-4 py-3 font-medium text-white",children:[e.jsx("span",{children:s("reqAcc.next")}),e.jsx(k,{})]})})]}),o===2&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(G,{label:s("reqAcc.affiliation"),fieldName:"affiliation",options:R,value:a.affiliation,onChange:V,placeholder:s("reqAcc.enterAffiliation"),error:t.affiliation}),e.jsx(g,{label:s("reqAcc.email"),type:"email",name:"email",placeholder:s("reqAcc.enterEmail"),value:a.email,onChange:h,error:t.email}),e.jsx(g,{label:s("reqAcc.password"),type:"password",name:"password",placeholder:s("reqAcc.enterPassword"),value:a.password,onChange:h,error:t.password})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsxs("button",{type:"button",onClick:A,className:"inline-flex items-center gap-2 border border-cyanToBlue px-4 py-3 text-gray-600",children:[e.jsx(I,{}),e.jsx("span",{children:s("reqAcc.back")})]}),e.jsxs("button",{type:"button",onClick:w,className:"inline-flex items-center gap-2 bg-cyan-to-blue px-4 py-3 text-white",children:[e.jsx("span",{children:s("reqAcc.next")}),e.jsx(k,{})]})]})]}),o===3&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"mb-4 text-center text-lg font-semibold",children:s("reqAcc.reviewYourInformation")}),e.jsx("div",{className:"rounded-xl border p-6 text-gray-900 dark:text-gray-200",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-semibold",children:[s("reqAcc.employeeNumber"),":"]})," ",a.userId]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-semibold",children:[s("reqAcc.firstName"),":"]})," ",a.firstName]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-semibold",children:[s("reqAcc.lastName"),":"]})," ",a.lastName]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-semibold",children:[s("reqAcc.affiliation"),":"]})," ",a.affiliation]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-semibold",children:[s("reqAcc.email"),":"]})," ",a.email]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-semibold",children:[s("reqAcc.password"),":"]})," ","********"]})]})})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsxs("button",{type:"button",onClick:A,className:"inline-flex items-center gap-2 bg-gray-100 px-4 py-3",children:[e.jsx(I,{}),e.jsx("span",{children:s("reqAcc.back")})]}),e.jsx("button",{type:"submit",disabled:p,className:`inline-flex items-center gap-2 bg-cyan-to-blue px-4 py-3 text-white ${p?"cursor-not-allowed opacity-50":""}`,children:e.jsx("span",{children:s("reqAcc.requestNow")})})]})]})]}),e.jsxs("div",{className:"mt-4 flex-col text-center",children:[e.jsx(S,{to:"/login",children:e.jsx("button",{type:"button",name:"back-to-login",className:"inline-flex items-center gap-2 border p-3 text-gray-600 dark:text-gray-100",children:e.jsx(z,{size:25})})}),e.jsx("span",{className:"flex p-4 text-sm text-gray-600 dark:text-white",children:s("reqAcc.goToLogin")})]}),e.jsx(U,{result:C,onClose:()=>q(""),message:m})]})};export{Q as default};
